// Generated by CoffeeScript 1.3.3
(function() {
  var NavHTMLBuilder, ScrollNavigation,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

  NavHTMLBuilder = (function() {

    NavHTMLBuilder.prototype.SCROLL_NAV_HTML = '<div class="scroll-nav"></div>';

    NavHTMLBuilder.prototype.SCROLL_NAV_SECTION_HTML = '<a class="scroll-nav-section-link">\n  <div class="scroll-nav-section">\n    <img class="scroll-nav-section-img"/>\n    <span class="scroll-nav-tooltip"></span>\n  </div>\n</a>';

    function NavHTMLBuilder(pageSections) {
      var navContainer, navSection, section, _i, _len, _ref;
      this.pageSections = pageSections;
      this.buildNavSectionHtml = __bind(this.buildNavSectionHtml, this);

      navContainer = $(this.SCROLL_NAV_HTML);
      _ref = this.pageSections;
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        section = _ref[_i];
        navSection = this.buildNavSectionHtml($(section).data());
        navContainer.append(navSection);
      }
      $("body").append(navContainer);
    }

    NavHTMLBuilder.prototype.buildNavSectionHtml = function(sectionData) {
      var navSection;
      navSection = $(this.SCROLL_NAV_SECTION_HTML);
      navSection.attr("href", "#" + sectionData.sectionLink);
      navSection.find(".scroll-nav-section").attr("data-nav", sectionData.sectionLink);
      navSection.find(".scroll-nav-section-img").attr("src", sectionData.imgSrc);
      navSection.find(".scroll-nav-section-img").addClass(sectionData.imgClass);
      navSection.find(".scroll-nav-tooltip").html(sectionData.sectionTitle);
      return navSection;
    };

    return NavHTMLBuilder;

  })();

  ScrollNavigation = (function() {

    function ScrollNavigation(config) {
      this.config = config;
      this.deSelectScrollNavSection = __bind(this.deSelectScrollNavSection, this);

      this.selectScrollNavSection = __bind(this.selectScrollNavSection, this);

      this.bindEvents = __bind(this.bindEvents, this);

      this.setNavItemHeight = __bind(this.setNavItemHeight, this);

      this.setupConfig = __bind(this.setupConfig, this);

      this.setupConfig();
      this.pageSections = $(this.config.pageSectionSelector);
      this.numberOfNavItems = this.pageSections.length;
      if (this.numberOfNavItems < 1) {
        return false;
      }
      new NavHTMLBuilder(this.pageSections);
      this.setNavItemHeight();
      this.bindEvents();
    }

    ScrollNavigation.prototype.setupConfig = function() {
      return this.config = jQuery.extend({
        pageSectionSelector: ".navigable-section",
        viewportOffsetTop: 0,
        viewportOffsetHeight: 0
      }, this.config);
    };

    ScrollNavigation.prototype.setNavItemHeight = function() {
      var navHeight;
      navHeight = $(".scroll-nav").height();
      return $(".scroll-nav-section").height(navHeight / this.numberOfNavItems);
    };

    ScrollNavigation.prototype.bindEvents = function() {
      return this.pageSections.bind("enterviewport", this.selectScrollNavSection).bind("leaveviewport", this.deSelectScrollNavSection).bullseye({
        offsetTop: this.config.viewportOffsetTop,
        offsetHeight: this.config.viewportOffsetHeight
      });
    };

    ScrollNavigation.prototype.selectScrollNavSection = function(event) {
      var activeSection;
      activeSection = $(event.target).data("sectionLink");
      return $(".scroll-nav-section[data-nav='" + activeSection + "']").addClass("selected");
    };

    ScrollNavigation.prototype.deSelectScrollNavSection = function(event) {
      var inactiveSection;
      inactiveSection = $(event.target).data("sectionLink");
      return $(".scroll-nav-section[data-nav='" + inactiveSection + "']").removeClass("selected");
    };

    return ScrollNavigation;

  })();

  window.ScrollNavigation = ScrollNavigation;

}).call(this);
